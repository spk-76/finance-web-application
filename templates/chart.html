{% extends "layout.html" %}

{% block main %}

<h2>Stock Graph</h2>

<form action="/chart" method="post" class="mb-4" style="max-width: 350px; margin: 0 auto;">
    <input name="symbol" class="form-control mb-3" placeholder="Enter symbol (e.g., AAPL)">
    <button class="btn btn-primary w-100" type="submit">Show Graph</button>
</form>

{% if prices %}
<h3>{{ symbol }} â€” 30-Day Price Chart</h3>
<canvas id="stockChart" width="600" height="300"></canvas>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const ctx = document.getElementById('stockChart').getContext('2d');
    new Chart(ctx, {
        type: 'line',
        data: {
            labels: [...Array({{ prices|length }}).keys()].map(x => "Day " + (x+1)),
            datasets: [{
                label: "{{ symbol }} Price",
                data: {{ prices }},
                borderWidth: 2,
                fill: false,
                borderColor: "blue",
                tension: 0.3
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: false }
            }
        }
    });
</script>
{% endif %}

{% endblock %}
